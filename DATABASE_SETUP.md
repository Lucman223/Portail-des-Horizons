# Configuración de Base de Datos (Supabase)

Para activar el formulario, necesitas crear un proyecto en Supabase:

1.  Ve a [https://supabase.com/](https://supabase.com/) y crea una cuenta gratuita.
2.  Crea un nuevo proyecto ("New Project").
3.  Ve a **Project Settings > API**.
4.  Copia la `URL` y la `anon` (public) key.
5.  Crea un archivo `.env` en la carpeta `app` y pega esto:

```env
NEXT_PUBLIC_SUPABASE_URL=TU_URL_AQUI
NEXT_PUBLIC_SUPABASE_ANON_KEY=TU_CLAVE_ANON_AQUI
```

6.  Ve al **SQL Editor** en Supabase y ejecuta este comando para crear la tabla:

```sql
create table enrollments (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  full_name text not null,
  email text not null,
  phone text not null,
  study_level text not null,
  status text default 'pending' check (status in ('pending', 'approved', 'rejected')),
  documents_url text[] -- Array of URLs to uploaded files
);

-- Habilitar almacenamiento (Storage) para documentos
insert into storage.buckets (id, name) values ('applications', 'applications');

-- Permitir subir archivos (Política de seguridad)
create policy "Public Access" on storage.objects for select using ( bucket_id = 'applications' );
create policy "Public Upload" on storage.objects for insert with check ( bucket_id = 'applications' );

-- IMPORTANTE: Habilitar seguridad para la tabla de inscripciones
alter table enrollments enable row level security;
create policy "Public Insert Enrollments" on enrollments for insert with check (true);
create policy "Admin Select Enrollments" on enrollments for select using (true);
```

### Nuevas Tablas para Admin y Partners

Ejecuta esto en el SQL Editor de Supabase:

```sql
-- Tabla para estadísticas (Visitas y Clics)
create table stats (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  type text not null check (type in ('visit', 'whatsapp_click'))
);

-- Políticas para stats
alter table stats enable row level security;
create policy "Public Insert Stats" on stats for insert with check (true);
create policy "Admin Select Stats" on stats for select using (true);

-- Tabla para Partners
create table partnerships (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  organization_name text not null,
  contact_person text not null,
  email text not null,
  type text not null,
  message text,
  status text default 'pending'
);

-- Políticas para partnerships
alter table partnerships enable row level security;
create policy "Public Insert Partners" on partnerships for insert with check (true);
create policy "Admin Select Partners" on partnerships for select using (true);
```
